namespace SpriteKind {
    export const images = SpriteKind.create()
    export const game_option = SpriteKind.create()
    export const coinOne = SpriteKind.create()
    export const coinTwo = SpriteKind.create()
    export const Shroom = SpriteKind.create()
    export const Turtle = SpriteKind.create()
    export const Shell = SpriteKind.create()
    export const Coin = SpriteKind.create()
    export const Prize = SpriteKind.create()
}

controller.right.onEvent(ControllerButtonEvent.Released, function on_right_released() {
    animation.stopAnimation(animation.AnimationTypes.All, marioLevel)
    if (tall) {
        marioLevel.setImage(assets.image`tall_mario_right0`)
    } else {
        marioLevel.setImage(assets.image`
            mario_right
        `)
    }
    
})
controller.left.onEvent(ControllerButtonEvent.Released, function on_left_released() {
    animation.stopAnimation(animation.AnimationTypes.All, marioLevel)
    if (tall) {
        marioLevel.setImage(assets.image`
            tall_mario_left
        `)
    } else {
        marioLevel.setImage(assets.image`
            mario_left
        `)
    }
    
})
sprites.onDestroyed(SpriteKind.coinTwo, function on_on_destroyed(sprite2: Sprite) {
    
    listCoinIndex = 0
})
function jumpAnimation() {
    animation.stopAnimation(animation.AnimationTypes.All, marioLevel)
    if (tall) {
        if (facingRight) {
            marioLevel.setImage(assets.image`
                tall_mario_jump_right
            `)
        } else {
            marioLevel.setImage(assets.image`
                tall_mario_jump_left
            `)
        }
        
    } else if (facingRight) {
        marioLevel.setImage(assets.image`
                jump_right
            `)
    } else {
        marioLevel.setImage(assets.image`
                jump_left
            `)
    }
    
}

function initializeMenu() {
    
    backgroundmenu = sprites.create(assets.image`
        background-menu
    `, SpriteKind.images)
    mario = sprites.create(assets.image`
        mario_stan_def
    `, SpriteKind.images)
    title_onep = sprites.create(assets.image`
            title-1-player
        `, SpriteKind.game_option)
    title_twop = sprites.create(assets.image`
            title-2-player
        `, SpriteKind.game_option)
    selector_ig = sprites.create(assets.image`
        selector
    `, SpriteKind.game_option)
    selector = 0
    spriteCoinBrillante = sprites.create(assets.image`
        coin one
    `, SpriteKind.coinOne)
    spriteCoinOscura = sprites.create(assets.image`
        coin two
    `, SpriteKind.coinTwo)
    listCoins = [spriteCoinBrillante, spriteCoinOscura]
    mario.setPosition(40, 99)
    title_onep.setPosition(80, 70)
    title_twop.setPosition(80, 85)
    title_onep.setScale(0.9, ScaleAnchor.Middle)
    title_twop.setScale(0.9, ScaleAnchor.Middle)
    selector_ig.setScale(0.5, ScaleAnchor.Middle)
    list2 = [title_onep, title_twop]
    changePostionSelector(selector)
    buildCabecera()
}

sprites.onDestroyed(SpriteKind.coinOne, function on_on_destroyed2(sprite: Sprite) {
    
    listCoinIndex = 1
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.Shroom, function on_on_overlap(sprite3: Sprite, otherSprite2: Sprite) {
    if (sprite3.y < otherSprite2.top) {
        otherSprite2.vx = 0
        animation.stopAnimation(animation.AnimationTypes.All, otherSprite2)
        jump()
        otherSprite2.setImage(assets.image`
            shroom_death
        `)
        pause(450)
        sprites.destroy(otherSprite2)
        info.changeScoreBy(100)
    } else {
        deathMario()
    }
    
})
controller.down.onEvent(ControllerButtonEvent.Pressed, function on_down_pressed() {
    
    if (selector == 0) {
        selector = 1
        changePostionSelector(selector)
    }
    
})
function buildCabecera() {
    
    scr = convertToText(score)
    x = scr.length
    while (x < 7) {
        strTemp = "" + strTemp + "0"
        x += 1
    }
    y = convertToText(coins).length
    while (y < 2) {
        strCoins = "" + strCoins + "0"
        y += 1
    }
    strCoins = "" + strCoins + convertToText(coins)
    strTemp = "" + strTemp + scr
    textScore = textsprite.create(strTemp)
    titleScore = textsprite.create("SCORE")
    titleCoins = textsprite.create("X" + strCoins)
    listCoinIndex = 1
    titleTime = textsprite.create("TIME")
    titleScore.setMaxFontHeight(1)
    titleTime.setMaxFontHeight(1)
    textScore.setMaxFontHeight(1)
    titleScore.setPosition(30, 3)
    titleTime.setPosition(123, 3)
    textScore.setPosition(30, 10)
    titleCoins.setPosition(79, 9)
    colocateCoin(spriteCoinBrillante)
    colocateCoin(spriteCoinOscura)
    while (true) {
        pause(500)
        if (listCoinIndex == 0) {
            sprites.destroy(spriteCoinBrillante)
            spriteCoinOscura = sprites.create(assets.image`
                coin two
            `, SpriteKind.coinTwo)
            colocateCoin(spriteCoinOscura)
        } else {
            sprites.destroy(spriteCoinOscura)
            spriteCoinBrillante = sprites.create(assets.image`
                coin one
            `, SpriteKind.coinOne)
            colocateCoin(spriteCoinBrillante)
        }
        
    }
}

scene.onHitWall(SpriteKind.Player, on_hit_wall)
function on_hit_wall(sprite6: Sprite, location2: tiles.Location) {
    if (sprite6.isHittingTile(CollisionDirection.Right)) {
        sprite6.vx = -50
    } else if (sprite6.isHittingTile(CollisionDirection.Left)) {
        sprite6.vx = 50
    }
    
}

scene.onHitWall(SpriteKind.Food, on_hit_wall)
function startGame() {
    let prize: Sprite;
    
    scene.setBackgroundImage(img`
        9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
                9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    `)
    tiles.setCurrentTilemap(tilemap`
        level_1_0
    `)
    if (tall) {
        marioLevel = sprites.create(assets.image`
                tall_mario_right0
            `, SpriteKind.Player)
    } else {
        marioLevel = sprites.create(assets.image`
            mario_right
        `, SpriteKind.Player)
    }
    
    createPlayer(marioLevel)
    marioLevel.ay = 350
    info.setLife(3)
    info.setScore(0)
    info.startCountdown(400)
    for (let value of tiles.getTilesByType(assets.tile`
        prize_block
    `)) {
        prize = sprites.create(assets.image`
            prize_block_0
        `, SpriteKind.Prize)
        tiles.placeOnTile(prize, value)
        animation.runImageAnimation(prize, assets.animation`
                prize_block_anim
            `, 200, true)
    }
}

scene.onHitWall(SpriteKind.Shroom, function on_hit_wall2(sprite5: Sprite, location: tiles.Location) {
    if (sprite5.isHittingTile(CollisionDirection.Right)) {
        sprite5.vx = -50
    } else if (sprite5.isHittingTile(CollisionDirection.Left)) {
        sprite5.vx = 50
    }
    
})
controller.right.onEvent(ControllerButtonEvent.Pressed, function on_right_pressed() {
    
    facingRight = 1
    if (marioLevel.vy == 0) {
        if (tall) {
            animation.runImageAnimation(marioLevel, assets.animation`
                                tall_mario_walk_right
                            `, 150, true)
        } else {
            animation.runImageAnimation(marioLevel, assets.animation`
                    mario_walk_right
                `, 150, true)
        }
        
    }
    
})
function deathMario() {
    info.stopCountdown()
    info.changeLifeBy(-1)
    info.setScore(0)
    info.changeCountdownBy(400 - info.countdown())
    tiles.setCurrentTilemap(tilemap`level_1_0`)
    sprites.destroyAllSpritesOfKind(SpriteKind.Shroom)
    sprites.destroyAllSpritesOfKind(SpriteKind.Turtle)
    sprites.destroyAllSpritesOfKind(SpriteKind.Shell)
    tiles.placeOnTile(marioLevel, tiles.getTileLocation(0, 13))
    spawnEnemies()
}

controller.left.onEvent(ControllerButtonEvent.Pressed, function on_left_pressed() {
    
    facingRight = 0
    if (marioLevel.vy == 0) {
        if (tall) {
            animation.runImageAnimation(marioLevel, assets.animation`
                    tall_mario_walk_left
                `, 150, true)
        } else {
            animation.runImageAnimation(marioLevel, assets.animation`
                    mario_walk_left
                `, 150, true)
        }
        
    }
    
})
function changePostionSelector(selection: number) {
    selector_ig.setPosition(list2[selection].x - 38, list2[selection].y + 1)
}

function initializeGame() {
    
    tall = 0
    score = 0
    level = 0
    coins = 0
}

sprites.onOverlap(SpriteKind.Player, SpriteKind.Turtle, function on_on_overlap2(sprite22: Sprite, otherSprite22: Sprite) {
    
    if (sprite22.y < otherSprite22.top) {
        otherSprite22.vx = 0
        animation.stopAnimation(animation.AnimationTypes.All, otherSprite22)
        jump()
        sprites.destroy(otherSprite22)
        info.changeScoreBy(100)
        shell = sprites.create(assets.image`
            shell_sprite
        `, SpriteKind.Shell)
        tiles.placeOnTile(shell, otherSprite22.tilemapLocation())
        shell.ay = 350
    } else {
        deathMario()
    }
    
})
controller.A.onEvent(ControllerButtonEvent.Pressed, function on_a_pressed() {
    
    if (level == 0 && selector == 0) {
        level = 1
        startGame()
        destroyMenu()
    } else if (level != 0) {
        if (marioLevel.vy == 0) {
            jump()
        }
        
    }
    
})
function spawnEnemies() {
    
    for (let value of tiles.getTilesByType(assets.tile`
        myTile2
    `)) {
        if (marioLevel.tilemapLocation().column + scene.screenWidth() > value.column) {
            shroom = sprites.create(assets.image`
                shroom_sprite0
            `, SpriteKind.Shroom)
            tiles.placeOnTile(shroom, value)
            tiles.setTileAt(value, assets.tile`
                transparency16
            `)
            shroom.vx = -20
            animation.runImageAnimation(shroom, [img`
                        . . . . . . e e e e . . . . . . 
                                        . . . . . e e e e e e . . . . . 
                                        . . . . e e e e e e e e . . . . 
                                        . . . e e e e e e e e e e . . . 
                                        . . e f f e e e e e e f f e . . 
                                        . e e e d f e e e e f d e e e . 
                                        . e e e d f f f f f f d e e e . 
                                        e e e e d f d e e d f d e e e e 
                                        e e e e d d d e e d d d e e e e 
                                        e e e e e e e e e e e e e e e e 
                                        . e e e e d d d d d d e e e e . 
                                        . . . . d d d d d d d d . . . . 
                                        . . f f d d d d d d d d . . . . 
                                        . f f f f d d d d d d f f . . . 
                                        . f f f f f d d d d f f f . . . 
                                        . . f f f f f . . f f f . . . .
                    `, img`
                        . . . . . . e e e e . . . . . . 
                                        . . . . . e e e e e e . . . . . 
                                        . . . . e e e e e e e e . . . . 
                                        . . . e e e e e e e e e e . . . 
                                        . . e f f e e e e e e f f e . . 
                                        . e e e d f e e e e f d e e e . 
                                        . e e e d f f f f f f d e e e . 
                                        e e e e d f d e e d f d e e e e 
                                        e e e e d d d e e d d d e e e e 
                                        e e e e e e e e e e e e e e e e 
                                        . e e e e d d d d d d e e e e . 
                                        . . . . d d d d d d d d . . . . 
                                        . . . . d d d d d d d d f f . . 
                                        . . . f f d d d d d d f f f f . 
                                        . . . f f f d d d d f f f f f . 
                                        . . . . f f f . . f f f f f . .
                    `], 500, true)
            shroom.ay = 160
            shroom.setBounceOnWall(false)
        }
        
    }
    for (let value2 of tiles.getTilesByType(assets.tile`
        myTile
    `)) {
        if (marioLevel.tilemapLocation().column + scene.screenWidth() > value2.column) {
            turtle = sprites.create(assets.image`
                turtle_sprite
            `, SpriteKind.Turtle)
            tiles.placeOnTile(turtle, value2)
            tiles.setTileAt(value2, assets.tile`
                transparency16
            `)
            turtle.vx = -20
        }
        
    }
}

controller.up.onEvent(ControllerButtonEvent.Pressed, function on_up_pressed() {
    
    if (selector == 1) {
        selector = 0
        changePostionSelector(selector)
    }
    
})
info.onLifeZero(function on_life_zero() {
    game.gameOver(false)
})
function jump() {
    jumpAnimation()
    marioLevel.vy = -220
}

function createPlayer(player2: Sprite) {
    scene.cameraFollowSprite(player2)
    tiles.placeOnTile(player2, tiles.getTileLocation(0, 13))
    controller.moveSprite(player2, 100, 0)
}

function destroyMenu() {
    sprites.destroyAllSpritesOfKind(SpriteKind.images)
    sprites.destroyAllSpritesOfKind(SpriteKind.game_option)
    sprites.destroyAllSpritesOfKind(SpriteKind.coinTwo)
    sprites.destroyAllSpritesOfKind(SpriteKind.coinOne)
}

sprites.onOverlap(SpriteKind.Player, SpriteKind.Shell, function on_on_overlap3(sprite32: Sprite, otherSprite3: Sprite) {
    otherSprite3.vx = sprite32.x * 2
    otherSprite3.setBounceOnWall(true)
})
function colocateCoin(mySprite: Sprite) {
    mySprite.setPosition(65, 9)
}

sprites.onOverlap(SpriteKind.Player, SpriteKind.Food, function on_on_overlap4(sprite4: Sprite, otherSprite: Sprite) {
    
    sprites.destroy(otherSprite)
    tall = 1
})
game.onUpdate(function on_on_update() {
    let coin: Sprite;
    
    if (level != 0) {
        spawnEnemies()
        for (let value of sprites.allOfKind(SpriteKind.Prize)) {
            if (marioLevel.tilemapLocation().column == value.tilemapLocation().column && marioLevel.tilemapLocation().row == value.tilemapLocation().row + 1) {
                coin = sprites.create(assets.image`
                    coin_sprite
                `, SpriteKind.Coin)
                tiles.placeOnTile(coin, value.tilemapLocation())
                coin.vy = -200
                coin.ay = 400
                info.changeScoreBy(10)
                animation.stopAnimation(animation.AnimationTypes.All, value)
                sprites.destroy(value)
                tiles.setTileAt(value.tilemapLocation(), assets.tile`
                    myTile1
                `)
            }
            
        }
        for (let value222 of tiles.getTilesByType(assets.tile`
            prize_block_boost
        `)) {
            if (marioLevel.tilemapLocation().column == value222.column && marioLevel.tilemapLocation().row == value222.row + 1) {
                boost = sprites.create(assets.image`
                    boost_sprite
                `, SpriteKind.Food)
                tiles.placeOnTile(boost, tiles.getTileLocation(value222.column, value222.row - 1))
                boost.vx = 50
                boost.ay = 160
                tiles.setTileAt(value222, assets.tile`
                    myTile1
                `)
            }
            
        }
    }
    
})
game.onUpdate(function on_on_update2() {
    if (level != 0) {
        checkFall()
        if (marioLevel.vx == 0 && marioLevel.vy == 0) {
            if (tall) {
                if (facingRight) {
                    marioLevel.setImage(assets.image`
                        tall_mario_right0
                    `)
                } else {
                    marioLevel.setImage(assets.image`
                        tall_mario_left
                    `)
                }
                
            } else if (facingRight) {
                marioLevel.setImage(assets.image`
                    mario_right
                `)
            } else {
                marioLevel.setImage(assets.image`
                    mario_left
                `)
            }
            
        }
        
    }
    
})
function checkFall() {
    if (marioLevel.tilemapLocation().row == 15) {
        deathMario()
    }
    
    for (let value of sprites.allOfKind(SpriteKind.Shroom)) {
        if (value.tilemapLocation().row == 15) {
            sprites.destroy(value)
        }
        
    }
    for (let value2 of sprites.allOfKind(SpriteKind.Turtle)) {
        if (value2.tilemapLocation().row == 15) {
            sprites.destroy(value2)
        }
        
    }
    for (let value3 of sprites.allOfKind(SpriteKind.Food)) {
        if (value3.tilemapLocation().row == 15) {
            sprites.destroy(value3)
        }
        
    }
    for (let value4 of sprites.allOfKind(SpriteKind.Shell)) {
        if (value4.tilemapLocation().row == 15) {
            sprites.destroy(value4)
        }
        
    }
}

scene.onHitWall(SpriteKind.Coin, function on_hit_wall3(sprite: Sprite, location: tiles.Location) {
    if (sprite.tileKindAt(TileDirection.Bottom, assets.tile`
        myTile1
    `)) {
        sprites.destroy(sprite)
    }
    
})
let boost : Sprite = null
let turtle : Sprite = null
let shroom : Sprite = null
let shell : Sprite = null
let level = 0
let titleTime : TextSprite = null
let titleCoins : TextSprite = null
let titleScore : TextSprite = null
let textScore : TextSprite = null
let strCoins = ""
let coins = 0
let y = 0
let strTemp = ""
let x = 0
let score = 0
let scr = ""
let list2 : Sprite[] = []
let listCoins : Sprite[] = []
let spriteCoinOscura : Sprite = null
let spriteCoinBrillante : Sprite = null
let selector = 0
let selector_ig : Sprite = null
let title_twop : Sprite = null
let title_onep : Sprite = null
let mario : Sprite = null
let backgroundmenu : Sprite = null
let listCoinIndex = 0
let tall = 0
let facingRight = 1
let marioLevel : Sprite = null
initializeGame()
initializeMenu()
